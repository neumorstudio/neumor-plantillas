---
/**
 * Template: Gimnasio
 * Renderiza la plantilla de gym usando datos del tenant
 */
import type { TenantData } from "../../middleware";

// Import components from gym template
import Layout from "@gym/layouts/Layout.astro";
import Header from "@gym/components/Header.astro";
import { HeroClassic, HeroModern, HeroBold, HeroMinimal } from "@gym/components/Hero";
import { ClassesTabs, ClassesGrid, ClassesList, ClassesCarousel } from "@gym/components/Classes";
import { FeaturesCards, FeaturesIcons, FeaturesBanner } from "@gym/components/Features";
import { FooterFull, FooterMinimal, FooterCentered } from "@gym/components/Footer";

// Get tenant from middleware
const tenant = Astro.locals.tenant as TenantData;
const config = tenant.config as Record<string, unknown>;

// Component mapping
const componentMap = {
  hero: { classic: HeroClassic, modern: HeroModern, bold: HeroBold, minimal: HeroMinimal },
  classes: { tabs: ClassesTabs, grid: ClassesGrid, list: ClassesList, carousel: ClassesCarousel },
  features: { cards: FeaturesCards, icons: FeaturesIcons, banner: FeaturesBanner },
  footer: { full: FooterFull, minimal: FooterMinimal, centered: FooterCentered },
};

// Get variants from config or use defaults
const variants = (config.variants as Record<string, string>) || {
  hero: "bold",
  classes: "tabs",
  features: "cards",
  footer: "full",
};

// Select components based on variants
const Hero = componentMap.hero[variants.hero as keyof typeof componentMap.hero] || HeroBold;
const Classes = componentMap.classes[variants.classes as keyof typeof componentMap.classes] || ClassesTabs;
const Features = componentMap.features[variants.features as keyof typeof componentMap.features] || FeaturesCards;
const FooterComponent = componentMap.footer[variants.footer as keyof typeof componentMap.footer] || FooterFull;

// Build page config
const pageConfig = {
  gymName: tenant.businessName,
  theme: tenant.theme as "light" | "dark" | "auto",
  siteTitle: `${tenant.businessName} | Gimnasio`,
  siteDescription: (config.siteDescription as string) || "Tu gimnasio de confianza",
  heroTitle: (config.heroTitle as string) || "Transforma Tu Cuerpo",
  heroSubtitle: (config.heroSubtitle as string) || "Entrena con los mejores profesionales",
  heroImage: (config.heroImage as string) || "https://images.unsplash.com/photo-1534438327276-14e5300c3a48?w=800&q=80",
  address: (config.address as string) || "",
  phone: (config.phone as string) || "",
  email: (config.email as string) || "",
  socialLinks: (config.socialLinks as { instagram: string; facebook: string; youtube: string }) || {
    instagram: "#",
    facebook: "#",
    youtube: "#",
  },
};
---

<Layout
  title={pageConfig.siteTitle}
  description={pageConfig.siteDescription}
  theme={pageConfig.theme}
>
  <Header gymName={pageConfig.gymName} />

  <main>
    <Hero
      title={pageConfig.heroTitle}
      subtitle={pageConfig.heroSubtitle}
      backgroundImage={pageConfig.heroImage}
    />

    <Features />

    <Classes />
  </main>

  <FooterComponent
    gymName={pageConfig.gymName}
    address={pageConfig.address}
    phone={pageConfig.phone}
    email={pageConfig.email}
    socialLinks={pageConfig.socialLinks}
  />
</Layout>
